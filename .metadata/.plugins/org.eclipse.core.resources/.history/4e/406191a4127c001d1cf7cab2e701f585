package com.jpmc.theater.service;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.jpmc.theater.model.Movie;
import com.jpmc.theater.model.Showing;

@Service
public class MovieService {
	
	@Autowired
	Movie movie;
	
	private static int MOVIE_CODE_SPECIAL = 1;

	 public double calculateTicketPrice(Showing showing) {
	        return movie.getTicketPrice() - getDiscount(showing.getSequenceOfTheDay());
	    }

	    private double getDiscount(int showSequence) {
	        double specialDiscount = 0;
	        if (MOVIE_CODE_SPECIAL == movie.getSpecialCode()) {
	            specialDiscount = movie.getTicketPrice() * 0.2;  // 20% discount for special movie
	        }

	        double sequenceDiscount = 0;
	        if (showSequence == 1) {
	            sequenceDiscount = 3; // $3 discount for 1st show
	        } else if (showSequence == 2) {

	            sequenceDiscount = 2; // $2 discount for 2nd show
	        }
//	        else {
//	            throw new IllegalArgumentException("failed exception");
//	        }

	        // biggest discount wins
	        return specialDiscount > sequenceDiscount ? specialDiscount : sequenceDiscount;
	    }
}
