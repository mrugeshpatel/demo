package com.jpmc.theater.client;

import java.time.LocalDateTime;
import java.time.LocalTime;

import org.springframework.boot.web.client.RestTemplateBuilder;
import org.springframework.http.HttpEntity;
import org.springframework.http.HttpHeaders;
import org.springframework.http.HttpMethod;
import org.springframework.http.MediaType;
import org.springframework.stereotype.Component;
import org.springframework.web.client.RestTemplate;

import com.jpmc.theater.vo.BookingRequest;
import com.jpmc.theater.vo.BookingResponse;

@Component
public class ShowBookingClient {

	 public static void main(String[] args) {
		 RestTemplate restTemplate = new RestTemplate(); 
		 BookingRequest bookingRequest = createRequest();
		 HttpEntity<BookingRequest> request = new HttpEntity<>(bookingRequest);	 
		 //request.getHeaders().setContentType(MediaType.APPLICATION_JSON);
	     BookingResponse body = restTemplate.exchange("http://localhost:8080/api/v1/theater/reserve", HttpMethod.POST, request,
	    		 						BookingResponse.class, request).getBody();
	     
	     System.out.print(body.toString());
     }
	  
	 private static BookingRequest createRequest() {
		LocalDateTime localDateTime = LocalDateTime.now();
		LocalDateTime.of(localDateTime.toLocalDate(), LocalTime.of(9, 0));
		BookingRequest request = BookingRequest.builder()
				   .customer("Mike")
				   .theater("Regal")
				   .location("South Brunswick")
				   .showStartTime(LocalDateTime.of(localDateTime.toLocalDate(), LocalTime.of(9, 0)))
				   .movie("The Batman")
				   .noOfSeat(3)
				   .build();
		return request;
	}
}
